[General]
# > 跳过代理
skip-proxy = 192.168.0.0/24, 10.0.0.0/8, 172.16.0.0/12, 127.0.0.1, localhost, *.local
# > 排除简单主机名
exclude-simple-hostnames = true
# > Internet 测试 URL
internet-test-url = http://www.aliyun.com
# > 代理测速 URL
proxy-test-url = http://www.apple.com/
# > 测试超时（秒）
test-timeout = 3
# 增强版 Wi-Fi 助理
# Surge 会在 Wi-Fi 网络不佳时尝试使用数据网络建立连接。该功能将对所有连接生效，请仅当使用不限量的数据流量时开启。
wifi-assist = true
# DNS相关设置
# 传统 DNS 服务器设置
ipv6 = true
# 加密 DNS 服务器设置
allow-wifi-access = true
# 是否启动完整的 IPv6 支持 (默认值: false)参数：true：开启，false：关闭
ipv6-vif = auto
# Wi-Fi 访问
# Surge 可以作为 HTTP/SOCKS5 代理服务器向 Wi-Fi 网络下的其他设备提供服务器
http-api-tls = true
# 允许 IPv6 通过 Surge VIF。当希望 Surge 处理连接到 IPv6 地址的原始 TCP 连接时非常有用。可选项：true，false，auto，always
http-api-web-dashboard = true
# 使用HTTPS替代HTTP协议，需要先配置Mitm的CA证书，同时需要在客户端设备上手动安装并信任CA证书
all-hybrid = false
# 页面控制器：通过页面控制Surge， Safari输入127.0.0.1:6171,填入HTTP-API密码即可
show-error-page-for-reject = true
# 该选项可显著改善在弱 Wi-Fi 和网络切换时的网络体验。该选项对所有 TCP 连接和 DNS 查询生效。请仅当使用不限量的数据流量套餐时开启。
use-local-host-item-for-proxy = false
# 当遇到REJECT策略时显示错误页
allow-hotspot-access = true
# IP地址本地映射
include-all-networks = false
# 允许热点共享
include-local-networks = false
# 路由防火墙
# 包含所有的网络请求
geoip-maxmind-url = https://github.com/Masaiki/GeoIP2-CN/raw/release/Country.mmdb
# 包含本地网络请求
external-controller-access = leo@0.0.0.0:6170
# GeoIP 数据库，默认使用surge自带.Surge 默认是使用由 MaxMind 创建的 GeoLite2 数据库，但是它的信息不是那么的准确，从 Surge iOS 4.5.0 开始可以自定义 GeoIP 数据的 URL，需要为 MaxMind 的格式。
# 如果想使用第三方GeoIP，下面两个二选一即可，也可自行更换为其它第三方
# 在配置信息设置好 geoip-maxmind-url 后建议在图形界面打开「自动更新」开关（或者直接在图形界面中设置 URL 及开关）
http-api = leo@0.0.0.0:6171
# 远程控制器
# 允许外部控制器访问 Surge，Surge Dashboard 或 Surge CLI 进行管理控制
# 默认仅允许外部控制器通过 USB 进行控制。如果想要允许由 Wi-Fi 控制可以将 127.0.0.1 改为 0.0.0.0
wifi-access-socks5-port = 6153
loglevel = notify
# Always Real IP Hosts
# 当 Surge VIF 处理 DNS 问题时，此选项要求 Surge 返回一个真正的 IP 地址，而不是一个 Fake IP。
# DNS 数据包将被转发到上游 DNS 服务器。
# 例如由于游戏主机会使用 STUN 技术进行 NAT 穿透，需要进行一些额外的配置才能正常工作。
# SOCKS5 服务端口 (默认值: 6153)
udp-priority = true
# 高级
# 日志等级: warning, notify, info, verbose (默认值: notify)
# ⚠️ 不建议在日常使用中启用 verbose，因为这会严重降低性能。
read-etc-hosts = true
# Wi-Fi 访问
# Surge 可以作为 HTTP/SOCKS5 代理服务器向 Wi-Fi 网络下的其他设备提供服务器
dns-server = 223.5.5.5, 119.29.29.29, system
# Surge Mac 供外网访问的服务端口
# HTTP 服务端口 (默认值: 6152)
# SOCKS5 服务端口 (默认值: 6153)
# 开启后会提高处理 UDP 流量的优先级，当系统负载高时会有比较明显的作用 (如高性能联机游戏)
http-listen = 0.0.0.0
socks5-listen = 0.0.0.0
encrypted-dns-server = h3://dns.alidns.com/dns-query

[Ponte]
client-proxy-name = Proxy
server-proxy-name = Proxy

[Proxy Group]
Proxy = fallback, Flowercloud_0.2, HK, TW, JP, SG, US
HK = fallback, include-other-group=机场一, policy-regex-filter=(🇭🇰)|(港)|(Hong)|(HK)
TW = fallback, include-other-group=机场一, policy-regex-filter=(🇨🇳)|(台)|(Tai)|(TW)
JP = fallback, include-other-group=机场一, policy-regex-filter=(🇯🇵)|(日)|(Japan)|(JP)
SG = fallback, include-other-group=机场一, policy-regex-filter=(🇸🇬)|(新)|(Singapore)|(SG)
US = fallback, include-other-group=机场一, policy-regex-filter=(🇺🇸)|(美)|(States)|(US)
机场一 = fallback, policy-path=https://api.huacloud.xyz/sub?target=surge&ver=4&list=true&emoji=true&tfo=true&udp=true&url=https%3A%2F%2Fapi.flowercloud.xyz%2Fosubscribe.php%3Fsid%3D79146%26token%3D86YsB83NeQVt%26sip002%3D1, update-interval=0
Flowercloud_0.2 = fallback, include-other-group=机场一, policy-regex-filter=实验性, no-alert=0, hidden=0, include-all-proxies=0

[Rule]
OR,((DOMAIN-SET,https://anti-ad.net/surge2.txt), (RULE-SET,https://raw.githubusercontent.com/leohaol/Surge/main/MyBlockAds.list), (RULE-SET,https://raw.githubusercontent.com/leohaol/Surge/main/All-in-one-to-Ad-Rule.list)),REJECT
RULE-SET,blocked.list,Proxy
OR,((DOMAIN-SUFFIX,dl.nssurge.com), (DOMAIN,www.nssurge.com)),Proxy // surge
OR,((DOMAIN-KEYWORD,olddddd.com), (RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/NivodTV/NivodTV.list)),SG
SRC-IP,192.168.79.108,DIRECT // 小米智能插头
RULE-SET,apple.list,DIRECT
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Steam/Steam.list,DIRECT // Steam
RULE-SET,https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Surge/Microsoft/Microsoft.list,US
OR,((RULE-SET,SYSTEM), (RULE-SET,LAN), (GEOIP,CN)),DIRECT
FINAL,Proxy,dns-failed

[Host]
*.tencent.com = server:119.29.29.29
*.weixin.com = server:119.29.29.29
weixin.com = server:119.29.29.29
*testflight.apple.com = server:8.8.4.4
*.lan = server:syslib

[MITM]
skip-server-cert-verify = true
tcp-connection = true
h2 = true
ca-keystore-name = CA
# ca-passphrase = CEBBA58A

